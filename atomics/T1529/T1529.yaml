---
attack_technique: T1529
display_name: System Shutdown/Reboot

atomic_tests:
- name: Shutdown System - Windows
  auto_generated_guid: aa725484-8263-433e-8855-ae45804b63f3
  description: |
    This test shuts down a Windows system.

  supported_platforms:
    - windows

  input_arguments:
    timeout:
      description: Timeout period before shutdown (seconds)
      type: string
      default: 1

  executor:
    name: command_prompt
    elevation_required: true
    command: |
      shutdown /s /t #{timeout}

- name: Restart System - Windows
  auto_generated_guid: 3cb61d53-033e-4bed-83b9-cea6d8218aa6
  description: |
    This test restarts a Windows system.

  supported_platforms:
    - windows

  input_arguments:
    timeout:
      description: Timeout period before restart (seconds)
      type: string
      default: 1

  executor:
    name: command_prompt
    elevation_required: true
    command: |
      shutdown /r /t #{timeout}

- name: Restart System via `shutdown` - macOS/Linux
  auto_generated_guid: 64e98b62-b3ca-429a-a52c-55b4667c181b
  description: |
    This test restarts a macOS/Linux system.

  supported_platforms:
    - macos
    - linux

  input_arguments:
    timeout:
      description: Time to restart (can be minutes or specific time)
      type: string
      default: now

  executor:
    name: bash
    elevation_required: true # indicates whether command must be run with admin privileges. If the elevation_required attribute is not defined, the value is assumed to be false
    command: | # these are the actual attack commands, at least one command must be provided
      shutdown -r #{timeout}

- name: Shutdown System via `shutdown` - macOS/Linux
  auto_generated_guid: b6e6160a-0bc1-4faa-91aa-74ddba31023e
  description: |
    This test shuts down a macOS/Linux system using a halt.

  supported_platforms:
    - macos
    - linux

  input_arguments:
    timeout:
      description: Time to shutdown (can be minutes or specific time)
      type: string
      default: now

  executor:
    name: bash
    elevation_required: true # indicates whether command must be run with admin privileges. If the elevation_required attribute is not defined, the value is assumed to be false
    command: | # these are the actual attack commands, at least one command must be provided
      shutdown -h #{timeout}


- name: Restart System via `reboot` - macOS/Linux
  auto_generated_guid: 49bd5fa8-177a-4988-bf7e-c9c82d974a98
  description: |
    This test restarts a macOS/Linux system via `reboot`.

  supported_platforms:
    - macos
    - linux

  executor:
    name: bash
    elevation_required: true # indicates whether command must be run with admin privileges. If the elevation_required attribute is not defined, the value is assumed to be false
    command: | # these are the actual attack commands, at least one command must be provided
      reboot

- name: Shutdown System via `halt` - Linux
  auto_generated_guid: e64d5c12-a106-4314-ae3b-00333e7fcb47
  description: |
    This test shuts down a Linux system using `halt`.

  supported_platforms:
    - linux

  executor:
    name: bash
    elevation_required: true # indicates whether command must be run with admin privileges. If the elevation_required attribute is not defined, the value is assumed to be false
    command: | # these are the actual attack commands, at least one command must be provided
      halt -p

- name: Reboot System via `halt` - Linux
  auto_generated_guid: ae3651db-84f4-4322-8b1c-08e095507fa0
  description: |
    This test restarts a Linux system using `halt`.

  supported_platforms:
    - linux

  executor:
    name: bash
    elevation_required: true # indicates whether command must be run with admin privileges. If the elevation_required attribute is not defined, the value is assumed to be false
    command: | # these are the actual attack commands, at least one command must be provided
      halt --reboot

- name: Shutdown System via `poweroff` - Linux
  auto_generated_guid: a9e18980-4cf8-4938-9297-5f138cf9af10
  description: |
    This test shuts down a Linux system using `poweroff`.

  supported_platforms:
    - linux

  executor:
    name: bash
    elevation_required: true # indicates whether command must be run with admin privileges. If the elevation_required attribute is not defined, the value is assumed to be false
    command: | # these are the actual attack commands, at least one command must be provided
      poweroff

- name: Reboot System via `poweroff` - Linux
  auto_generated_guid: 42c94858-e8b4-4453-91d7-26ef711145b3
  description: |
    This test restarts a Linux system using `poweroff`.

  supported_platforms:
    - linux

  executor:
    name: bash
    elevation_required: true # indicates whether command must be run with admin privileges. If the elevation_required attribute is not defined, the value is assumed to be false
    command: | # these are the actual attack commands, at least one command must be provided
      poweroff --reboot
