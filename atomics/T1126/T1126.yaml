---
attack_technique: T1126
display_name: Remove Network Share

atomic_tests:
- name: Add Network Share
  auto_generated_guid: f3095f88-ec42-4652-b256-8b3bbecfb80f
  description: |
    Add a Network Share utilizing the command_prompt

  supported_platforms:
    - windows

  input_arguments:
    share_name:
      description: Share to add.
      type: string
      default: \\test\share

  executor:
    name: command_prompt
    elevation_required: false
    command: |
      net use c: #{share_name}
      net share test=#{share_name} /REMARK:"test share" /CACHE:No

- name: Remove Network Share
  auto_generated_guid: a53313e6-3bc1-4b9d-8b82-d49a11c0360f
  description: |
    Removes a Network Share utilizing the command_prompt

  supported_platforms:
    - windows

  input_arguments:
    share_name:
      description: Share to remove.
      type: string
      default: \\test\share

  executor:
    name: command_prompt
    elevation_required: false
    command: |
      net share #{share_name} /delete

- name: Remove Network Share PowerShell
  auto_generated_guid: 486ffeb1-4a34-40d4-ba88-f4cf2473995e
  description: |
    Removes a Network Share utilizing PowerShell

  supported_platforms:
    - windows

  input_arguments:
    share_name:
      description: Share to remove.
      type: string
      default: \\test\share

  executor:
    name: powershell
    elevation_required: false
    command: |
      Remove-SmbShare -Name #{share_name}
      Remove-FileShare -Name #{share_name}
