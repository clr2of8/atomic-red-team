---
attack_technique: T1113
display_name: Screen Capture

atomic_tests:
- name: Screencapture
  auto_generated_guid: 796abcf2-b149-46cf-bcdb-cf5b4c7d933c
  description: |
    Use screencapture command to collect a full desktop screenshot
  supported_platforms:
    - macos
  input_arguments:
    output_file:
      description: Output file path
      type: Path
      default: /tmp/T1113_desktop.png
  executor:
    name: bash
    elevation_required: false
    command: |
      screencapture #{output_file}
    cleanup_command: |
      rm #{output_file}

- name: Screencapture (silent)
  auto_generated_guid: 19847cfd-cb65-4543-a24b-ff26d7504279
  description: |
    Use screencapture command to collect a full desktop screenshot
  supported_platforms:
    - macos
  input_arguments:
    output_file:
      description: Output file path
      type: Path
      default: /tmp/T1113_desktop.png
  executor:
    name: bash
    elevation_required: false
    command: |
      screencapture -x #{output_file}
    cleanup_command: |
      rm #{output_file}

- name: X Windows Capture
  auto_generated_guid: 4e72ce4d-08df-46cd-92bf-6bce0dd3fa67
  description: |
    Use xwd command to collect a full desktop screenshot and review file with xwud
  supported_platforms:
    - linux
  input_arguments:
    output_file:
      description: Output file path
      type: Path
      default: /tmp/T1113_desktop.xwd
  executor:
    name: bash
    command: |
      xwd -root -out #{output_file}
      xwud -in #{output_file}
    cleanup_command: |
      rm #{output_file}

- name: Import
  auto_generated_guid: 14607672-7537-4006-9715-00ac1a4ad173
  description: |
    Use import command to collect a full desktop screenshot
  supported_platforms:
    - linux
  input_arguments:
    output_file:
      description: Output file path
      type: Path
      default: /tmp/T1113_desktop.png
  executor:
    name: bash
    command: |
      import -window root #{output_file}
    cleanup_command: |
      rm #{output_file}
