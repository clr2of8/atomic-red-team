---
attack_technique: T1148
display_name: HISTCONTROL

atomic_tests:
- name: Disable history collection
  auto_generated_guid: f56c2cae-a908-4a32-8e39-cd90f53739da
  description: |
    Disables history collection in shells
  supported_platforms:
    - linux
    - macos
  input_arguments:
    evil_command:
      description: Command to run after shell history collection is disabled
      type: String
      default: whoami
  executor:
    name: sh
    command: |
      export HISTCONTROL=ignoreboth
      ls #{evil_command}

- name: Mac HISTCONTROL
  auto_generated_guid: 190b9165-b1fe-42b4-ae55-0710e0aebf94
  description: |
    
  supported_platforms:
    - macos
    - linux

  executor:
    name: manual
    steps: |
      1. export HISTCONTROL=ignoreboth
      2. echo export "HISTCONTROL=ignoreboth" >> ~/.bash_profile
      3. ls
      4. whoami > recon.txt
