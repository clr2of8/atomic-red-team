---
attack_technique: T1154
display_name: Trap

atomic_tests:
- name: Trap
  auto_generated_guid: 23e7523f-c9e4-42e9-a87f-1cd4182f3c1b
  description: |
    After exiting the shell, the script will download and execute.

    After sending a keyboard interrupt (CTRL+C) the script will download and execute.
    
  supported_platforms:
    - macos
    - linux

  executor:
    name: sh
    command: |
      trap "nohup sh $PathToAtomicsFolder/T1154/src/echo-art-fish.sh | bash" EXIT
      exit
      trap "nohup sh $PathToAtomicsFolder/T1154/src/echo-art-fish.sh | bash" SIGINt
