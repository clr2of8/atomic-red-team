---
attack_technique: T1049
display_name: System Network Connections Discovery

atomic_tests:
- name: System Network Connections Discovery
  auto_generated_guid: ce0ddfe8-80b4-45b6-8e04-d10c3ccdd6a1
  description: |
    Get a listing of network connections.

    Upon successful execution, cmd.exe will execute `netstat`, `net use` and `net sessions`. Results will output via stdout.

  supported_platforms:
    - windows

  executor:
    name: command_prompt
    elevation_required: false
    command: |
      netstat
      net use
      net sessions

- name: System Network Connections Discovery with PowerShell
  auto_generated_guid: 9126a98d-a0ec-4da7-9bfc-5310d12a0fe9
  description: |
    Get a listing of network connections.

    Upon successful execution, powershell.exe will execute `get-NetTCPConnection`. Results will output via stdout.

  supported_platforms:
    - windows

  executor:
    name: powershell
    elevation_required: false
    command: |
      Get-NetTCPConnection

- name: System Network Connections Discovery Linux & MacOS
  auto_generated_guid: 6b512537-dc50-414c-8e71-184bbd658476
  description: |
    Get a listing of network connections.

    Upon successful execution, sh will execute `netstat` and `who -a`. Results will output via stdout.

  supported_platforms:
    - linux
    - macos
  dependency_executor_name: sh
  dependencies:
    - description: |
        Check if netstat command exists on the machine
      prereq_command: |
        if [ -x "$(command -v netstat)" ]; then exit 0; else exit 1;
      get_prereq_command: |
        echo "Install netstat on the machine."; exit 1;
  executor:
    name: sh
    elevation_required: false
    command: |
      netstat
      who -a
