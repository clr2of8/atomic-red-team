---
attack_technique: T1063
display_name: Security Software Discovery

atomic_tests:
- name: Security Software Discovery
  auto_generated_guid: a6f3a4a9-07fb-41da-bc9b-2160a512b396
  description: |
    Methods to identify Security Software on an endpoint

    when sucessfully executed, the test is going to display running processes, firewall configuration on network profiles
    and specific security software.

  supported_platforms:
    - windows

  executor:
    name: command_prompt
    elevation_required: false
    command: |
      netsh.exe advfirewall  show allprofiles
      tasklist.exe
      tasklist.exe | findstr /i virus
      tasklist.exe | findstr /i cb
      tasklist.exe | findstr /i defender
      tasklist.exe | findstr /i cylance

- name: Security Software Discovery - powershell
  auto_generated_guid: 8181b5c6-07a8-449b-b925-02e710972b47
  description: |
    Methods to identify Security Software on an endpoint

    when sucessfully executed, powershell is going to processes related AV products if they are running.

  supported_platforms:
    - windows

  executor:
    name: powershell
    elevation_required: false
    command: |
      get-process | ?{$_.Description -like "*virus*"}
      get-process | ?{$_.Description -like "*carbonblack*"}
      get-process | ?{$_.Description -like "*defender*"}
      get-process | ?{$_.Description -like "*cylance*"}

- name: Security Software Discovery - ps
  auto_generated_guid: 1f62b18a-bdc4-4a67-90f2-6457dc36b436
  description: |
    Methods to identify Security Software on an endpoint
    when sucessfully executed, command shell  is going to display AV software it is running( Little snitch or carbon black ).

  supported_platforms:
    - linux
    - macos

  executor:
    name: sh
    elevation_required: false
    command: |
      ps -ef | grep Little\ Snitch | grep -v grep
      ps aux | grep CbOsxSensorService

- name: Security Software Discovery - Sysmon Service
  auto_generated_guid: 4654b41b-34fc-467f-8c39-3220978dc22d
  description: |
    Discovery of an installed Sysinternals Sysmon service using driver altitude (even if the name is changed).

    when sucessfully executed, the test is going to display sysmon driver instance if it is installed.

  supported_platforms:
    - windows

  executor:
    name: command_prompt
    elevation_required: true
    command: |
      fltmc.exe | findstr.exe 385201

- name: Security Software Discovery - AV Discovery via WMI
  auto_generated_guid: 30249220-4bd7-4891-830f-383351ce781b
  description: |
    Discovery of installed antivirus products via a WMI query.

    when sucessfully executed, the test is going to display installed AV software.

  supported_platforms:
    - windows

  executor:
    name: command_prompt
    elevation_required: true
    command: |
      wmic.exe /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List