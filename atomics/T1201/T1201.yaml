---
attack_technique: T1201
display_name: Password Policy Discovery 

atomic_tests:
- name: Examine password complexity policy - Ubuntu
  auto_generated_guid: 62a7b0f7-aaaf-4e7a-894c-a93636d73b31
  description: |
    Lists the password complexity policy to console on Ubuntu Linux.

  supported_platforms:
    - linux

  executor:
    name: bash
    command: |
      cat /etc/pam.d/common-password

- name: Examine password complexity policy - CentOS/RHEL 7.x
  auto_generated_guid: 0c8d8362-4ae9-4066-a2ce-e5105239f0e5
  description: |
    Lists the password complexity policy to console on CentOS/RHEL 7.x Linux.

  supported_platforms:
    - linux

  dependencies:
    - description: |
        System must be CentOS or RHEL v7
      prereq_command: |
        if [ $(rpm -q --queryformat '%{VERSION}') -eq "7" ]; then exit /b 0; else exit /b 1; fi;
      get_prereq_command: |
        echo Please run from CentOS or RHEL v7

  executor:
    name: bash
    command: |
      cat /etc/security/pwquality.conf

- name: Examine password complexity policy - CentOS/RHEL 6.x
  auto_generated_guid: 27b55adf-2e83-4aca-ab47-071f670af187
  description: |
    Lists the password complexity policy to console on CentOS/RHEL 6.x Linux.

  supported_platforms:
    - linux

  dependencies:
    - description: |
        System must be CentOS or RHEL v6
      prereq_command: |
        if [ $(rpm -q --queryformat '%{VERSION}') -eq "6" ]; then exit /b 0; else exit /b 1; fi;
      get_prereq_command: |
        echo Please run from CentOS or RHEL v6

  executor:
    name: bash
    command: |
      cat /etc/pam.d/system-auth
      cat /etc/security/pwquality.conf

- name: Examine password expiration policy - All Linux
  auto_generated_guid: f2f3d640-9676-4ec3-ba3f-bbdbde30752e
  description: |
    Lists the password expiration policy to console on CentOS/RHEL/Ubuntu.

  supported_platforms:
    - linux

  executor:
    name: bash
    command: |
      cat /etc/login.defs

- name: Examine local password policy - Windows
  auto_generated_guid: e17fccb1-903c-4016-af88-78e103a2459b
  description: |
    Lists the local password policy to console on Windows.

  supported_platforms:
    - windows

  executor:
    name: command_prompt
    elevation_required: false
    command: |
      net accounts

- name: Examine domain password policy - Windows
  auto_generated_guid: d849cee2-01f0-47e4-acdf-a0ab06d3d851
  description: |
    Lists the domain password policy to console on Windows.

  supported_platforms:
    - windows

  executor:
    name: command_prompt
    elevation_required: false
    command: |
      net accounts /domain

- name: Examine password policy - macOS
  auto_generated_guid: cfabc8c0-19ad-4d87-bf3c-b52b612ab554
  description: |
    Lists the password policy to console on macOS.

  supported_platforms:
    - macos

  executor:
    name: bash
    command: |
      pwpolicy getaccountpolicies