---
attack_technique: T1045
display_name: Software Packing

atomic_tests:
- name: Binary simply packed by UPX (linux)
  auto_generated_guid: f3005d74-0301-4242-a894-b02c8221a8be
  description: |
    Copies and then runs a simple binary (just outputting "the cake is a lie"), that was packed by UPX.
    No other protection/compression were applied.

  supported_platforms:
    - linux

  input_arguments:
    bin_path:
      description: Packed binary
      type: Path
      default: PathToAtomicsFolder/T1045/bin/linux/test_upx

  executor:
    name: sh
    elevation_required: false
    command: |
      cp #{bin_path} /tmp/packed_bin && /tmp/packed_bin
    cleanup_command: |
      rm /tmp/packed_bin

- name: Binary packed by UPX, with modified headers (linux)
  auto_generated_guid: 6b17e27e-6374-4856-a6df-625268d100c6
  description: |
    Copies and then runs a simple binary (just outputting "the cake is a lie"), that was packed by UPX.

    The UPX magic number (`0x55505821`, "`UPX!`") was changed to (`0x4c4f5452`, "`LOTR`"). This prevents the binary from being detected
    by some methods, and especially UPX is not able to uncompress it any more.

  supported_platforms:
    - linux

  input_arguments:
    bin_path:
      description: Packed binary
      type: Path
      default: PathToAtomicsFolder/T1045/bin/linux/test_upx_header_changed

  executor:
    name: sh
    elevation_required: false
    command: |
      cp #{bin_path} /tmp/packed_bin && /tmp/packed_bin
    cleanup_command: |
      rm /tmp/packed_bin

- name: Binary simply packed by UPX
  auto_generated_guid: 5a154014-8217-44d6-9a21-6c8d6aa05252
  description: |
    Copies and then runs a simple binary (just outputting "the cake is a lie"), that was packed by UPX.
    No other protection/compression were applied.

  supported_platforms:
    - macos

  input_arguments:
    bin_path:
      description: Packed binary
      type: Path
      default: PathToAtomicsFolder/T1045/bin/darwin/test_upx

  executor:
    name: sh
    elevation_required: false
    command: |
      cp #{bin_path} /tmp/packed_bin && /tmp/packed_bin
    cleanup_command: |
      rm /tmp/packed_bin

- name: Binary packed by UPX, with modified headers
  auto_generated_guid: 024151a7-ddf9-4b90-a37b-5cdf3d846f61
  description: |
    Copies and then runs a simple binary (just outputting "the cake is a lie"), that was packed by UPX.

    The UPX magic number (`0x55505821`, "`UPX!`") was changed to (`0x4c4f5452`, "`LOTR`"). This prevents the binary from being detected
    by some methods, and especially UPX is not able to uncompress it any more.

  supported_platforms:
    - macos

  input_arguments:
    bin_path:
      description: Packed binary
      type: Path
      default: PathToAtomicsFolder/T1045/bin/darwin/test_upx_header_changed

  executor:
    name: sh
    elevation_required: false
    command: |
      cp #{bin_path} /tmp/packed_bin && /tmp/packed_bin
    cleanup_command: |
      rm /tmp/packed_bin
